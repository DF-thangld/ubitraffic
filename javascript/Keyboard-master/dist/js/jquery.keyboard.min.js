/*! jQuery UI Virtual Keyboard v1.20.0 */
!function(a,b,c){"use strict";a.keyboard=function(d,e){var f,g=this;g.version="1.20.0",g.$el=a(d),g.el=d,g.$el.data("keyboard",g),g.init=function(){var b=a.keyboard.css;g.settings=e||{},g.options=f=a.extend(!0,{},a.keyboard.defaultOptions,e),g.shiftActive=g.altActive=g.metaActive=g.sets=g.capsLock=!1,g.rows=["","-shift","-alt","-alt-shift"],a('<!--[if lte IE 8]><script>jQuery("body").addClass("oldie");</script><![endif]--><!--[if IE]><script>jQuery("body").addClass("ie");</script><![endif]-->').appendTo("body").remove(),g.msie=a("body").hasClass("oldie"),g.allie=a("body").hasClass("ie"),g.inPlaceholder=g.$el.attr("placeholder")||"",g.watermark="undefined"!=typeof c.createElement("input").placeholder&&""!==g.inPlaceholder,g.repeatTime=1e3/(f.repeatRate||20),f.preventDoubleEventTime=f.preventDoubleEventTime||100,g.isOpen=!1,g.wheel=a.isFunction(a.fn.mousewheel),g.alwaysAllowed=[20,33,34,35,36,37,38,39,40,45,46],g.$keyboard=[],f.position.orig_at=f.position.at,g.temp=a('<div style="height:0px;width:0px;overflow:hidden;"><input type="text" value="testing"></div>').insertAfter(g.el),g.temp.find("input").caret(3,3),g.checkCaret=f.lockInput||3!==g.temp.find("input").hide().show().caret().start,g.temp.remove(),g.last={start:0,end:0,key:"",val:"",keyset:[!1,!1,!1]},g.temp=["",0,0],a.each("initialized beforeVisible visible hidden canceled accepted beforeClose".split(" "),function(b,c){a.isFunction(f[c])&&g.$el.bind(c+".keyboard",f[c])}),f.alwaysOpen&&(f.stayOpen=!0),a(c).bind("mousedown keyup touchstart checkkeyboard ".split(" ").join(".keyboard "),function(c){if(!g.opening&&(g.escClose(c),c.target&&a(c.target).hasClass(b.input))){var d=a(c.target).data("keyboard");d===g&&d.options.openOn&&d.focusOn()}}),g.$el.addClass(b.input+" "+f.css.input).attr({"aria-haspopup":"true",role:"textbox"}),(g.$el.is(":disabled")||g.$el.attr("readonly")&&!g.$el.hasClass(b.locked))&&g.$el.addClass(b.noKeyboard),f.openOn&&g.$el.bind(f.openOn+".keyboard",function(){g.focusOn()}),g.watermark||""!==g.$el.val()||""===g.inPlaceholder||""===g.$el.attr("placeholder")||g.$el.addClass(b.placeholder).val(g.inPlaceholder),g.$el.trigger(a.keyboard.events.kbInit,[g,g.el]),f.alwaysOpen&&g.reveal()},g.setCurrent=function(){var b=a.keyboard.css;a("."+b.hasFocus).removeClass(b.hasFocus),a("."+b.isCurrent).removeClass(b.isCurrent),g.$el.addClass(b.isCurrent),g.$keyboard.addClass(b.hasFocus),g.isCurrent(!0),g.isOpen=!0},g.isCurrent=function(b){var c=a.keyboard.currentKeyboard||!1;return b?c=a.keyboard.currentKeyboard=g.el:b===!1&&c===g.el&&(c=a.keyboard.currentKeyboard=""),c===g.el},g.isVisible=function(){return g.$keyboard&&g.$keyboard.length?g.$keyboard.is(":visible"):!1},g.focusOn=function(){g.$el.is(":visible")&&setTimeout(function(){if(!/(number|email)/i.test(g.el.type)){var a=g.$el.caret();g.last.start=a.start,g.last.end=a.end}},20),g.isVisible()||(clearTimeout(g.timer),g.reveal()),f.alwaysOpen&&g.setCurrent()},g.reveal=function(b){var d=a.keyboard.css;return g.opening=!0,a("."+d.keyboard).not("."+d.alwaysOpen).remove(),b&&(g.isOpen=!1,g.last.value=g.$preview&&g.$preview.val()||"",g.$keyboard.length&&(g.$keyboard.remove(),g.$keyboard=[],g.shiftActive=g.altActive=g.metaActive=!1)),g.$el.is(":disabled")||g.$el.attr("readonly")&&!g.$el.hasClass(d.locked)?void g.$el.addClass(d.noKeyboard):(g.$el.removeClass(d.noKeyboard),f.openOn&&g.$el.unbind(f.openOn+".keyboard"),(!g.$keyboard||g.$keyboard&&(!g.$keyboard.length||a.contains(c.body,g.$keyboard[0])))&&g.startup(),g.watermark||g.el.value!==g.inPlaceholder||g.$el.removeClass(d.placeholder).val(""),g.originalContent=g.$el.val(),g.$preview.val(b?g.last.value:g.originalContent),f.acceptValid&&g.checkValid(),f.resetDefault&&(g.shiftActive=g.altActive=g.metaActive=!1,g.showKeySet()),f.appendLocally||"body"!==f.appendTo||g.$keyboard.css({position:"absolute",left:0,top:0}),g.$el.trigger(a.keyboard.events.kbBeforeVisible,[g,g.el]),g.setCurrent(),g.$keyboard.show(),f.usePreview&&g.msie&&("undefined"==typeof g.width&&(g.$preview.hide(),g.width=Math.ceil(g.$keyboard.width()),g.$preview.show()),g.$preview.width(g.width)),g.position=f.position,a.ui&&a.ui.position&&!a.isEmptyObject(g.position)&&(g.position.of=g.position.of||g.$el.data("keyboardPosition")||g.$el,g.position.collision=g.position.collision||"flipfit flipfit",f.position.at=f.usePreview?f.position.orig_at:f.position.at2,g.$keyboard.position(g.position)),g.checkDecimal(),g.lineHeight=parseInt(g.$preview.css("lineHeight"),10)||parseInt(g.$preview.css("font-size"),10)+4,f.caretToEnd&&(g.last.start=g.last.end=g.originalContent.length),g.allie&&(0===g.last.end&&g.last.start>0&&(g.last.end=g.last.start),g.last.start<0&&(g.last.start=g.last.end=g.originalContent.length)),setTimeout(function(){g.opening=!1,f.initialFocus&&g.$preview.focus().caret(g.last),g.$el.trigger(a.keyboard.events.kbVisible,[g,g.el])},10),g)},g.updateLanguage=function(){var b=a.keyboard.layouts,c=f.language||b[f.layout]&&b[f.layout].lang&&b[f.layout].lang||[f.language||"en"],d=a.keyboard.language;c=c[0].split("-")[0],f.display=a.extend(!0,{},d.en.display,d[c]&&d[c].display||{},g.settings.display),f.combos=a.extend(!0,{},d.en.combos,d[c]&&d[c].combos||{},g.settings.combos),f.wheelMessage=d[c]&&d[c].wheelMessage||d.en.wheelMessage,f.rtl=b[f.layout]&&b[f.layout].rtl||d[c]&&d[c].rtl||!1,g.regex=d[c]&&d[c].comboRegex||a.keyboard.comboRegex,g.decimal=/^\./.test(f.display.dec),g.$el.toggleClass("rtl",f.rtl).css("direction",f.rtl?"rtl":"")},g.startup=function(){var c=a.keyboard.css;g.$preview=g.$el,g.$keyboard&&g.$keyboard.length||("custom"===f.layout&&(f.layoutHash="custom"+g.customHash()),g.layout="custom"===f.layout?f.layoutHash:f.layout,g.updateLanguage(),"undefined"==typeof a.keyboard.builtLayouts[g.layout]&&(a.isFunction(f.create)&&f.create(g),g.$keyboard.length||g.buildKeyboard()),g.$keyboard=a.keyboard.builtLayouts[g.layout].$keyboard.clone(),f.usePreview?(f.position.at=f.position.orig_at,g.$preview=g.$el.clone(!1).removeAttr("id").removeClass(c.placeholder+" "+c.input).addClass(c.preview+" "+f.css.input).removeAttr("aria-haspopup").attr("tabindex","-1").show(),"number"==g.$preview.attr("type")&&g.$preview.attr("type","text"),a("<div />").addClass(c.wrapper).append(g.$preview).prependTo(g.$keyboard)):a.isEmptyObject(f.position)||(f.position.at=f.position.at2)),g.preview=g.$preview[0],g.$decBtn=g.$keyboard.find("."+c.keyPrefix+"dec"),(f.enterNavigation||"TEXTAREA"===g.el.tagName)&&g.alwaysAllowed.push(13),f.lockInput&&g.$preview.addClass(c.locked).attr({readonly:"readonly"}),g.bindKeyboard(),g.$keyboard.appendTo(f.appendLocally?g.$el.parent():f.appendTo||"body"),g.bindKeys(),f.reposition&&a.ui&&a.ui.position&&"body"==f.appendTo&&a(b).bind("resize.keyboard",function(){g.isVisible()&&g.$keyboard.position(g.position)})},g.bindKeyboard=function(){var b,d=a.keyboard.builtLayouts[g.layout];g.$preview.unbind("keypress keyup keydown mouseup touchend ".split(" ").join(".keyboard ")).bind("keypress.keyboard",function(c){if(f.lockInput)return!1;var e,h=g.last.key=String.fromCharCode(c.charCode||c.which);if(g.$lastKey=[],g.checkCaret&&(e=g.$preview.caret(),g.last.start=e.start,g.last.end=e.end),g.capsLock=h>=65&&90>=h&&!c.shiftKey||h>=97&&122>=h&&c.shiftKey?!0:!1,f.restrictInput){if((8===c.which||0===c.which)&&a.inArray(c.keyCode,g.alwaysAllowed))return;-1===a.inArray(h,d.acceptedKeys)&&(c.preventDefault(),b=a.extend({},c),b.type="restricted",g.$el.trigger(b,[g,g.el]),a.isFunction(f.restricted)&&f.restricted(b,g,g.el))}else if((c.ctrlKey||c.metaKey)&&(97===c.which||99===c.which||118===c.which||c.which>=120&&c.which<=122))return;d.hasMappedKeys&&d.mappedKeys.hasOwnProperty(h)&&(g.last.key=d.mappedKeys[h],g.insertText(g.last.key),c.preventDefault()),g.checkMaxLength()}).bind("keyup.keyboard",function(b){switch(b.which){case 9:if(g.tab&&f.tabNavigation&&!f.lockInput){g.shiftActive=b.shiftKey;var c=a.keyboard.keyaction.tab(g);if(g.tab=!1,!c)return!1}else b.preventDefault();break;case 27:return g.close(),!1}return clearTimeout(g.throttled),g.throttled=setTimeout(function(){g.isVisible()&&g.checkCombos()},100),g.checkMaxLength(),g.$el.trigger(a.keyboard.events.kbChange,[g,g.el]),g.last.val=g.$preview.val(),a.isFunction(f.change)?(f.change(a.Event("change"),g,g.el),!1):void 0}).bind("keydown.keyboard",function(b){switch(b.which){case 8:a.keyboard.keyaction.bksp(g,null,b),b.preventDefault();break;case 9:return f.tabNavigation?(g.tab=!0,!1):(g.tab=!0,!1);case 13:a.keyboard.keyaction.enter(g,null,b);break;case 20:g.shiftActive=g.capsLock=!g.capsLock,g.showKeySet(this);break;case 86:if(b.ctrlKey||b.metaKey){if(f.preventPaste)return void b.preventDefault();g.checkCombos()}}}).bind("mouseup.keyboard touchend.keyboard",function(){if(g.checkCaret){var a=g.$preview.caret();g.last.start=a.start,g.last.end=a.end}}),g.$keyboard.bind("mousedown.keyboard click.keyboard touchstart.keyboard",function(b){b.stopPropagation(),g.isCurrent()||(g.reveal(),a(c).trigger("checkkeyboard.keyboard"))}),f.preventPaste&&(g.$preview.bind("contextmenu.keyboard",function(a){a.preventDefault()}),g.$el.bind("contextmenu.keyboard",function(a){a.preventDefault()}))},g.bindKeys=function(){var b=a.keyboard.css,c=(f.keyBinding+" "+a.keyboard.events.kbRepeater+" mouseenter mouseleave touchstart mousewheel mouseup click ").split(" ").join(".keyboard ")+"mouseleave mousedown touchstart touchend touchmove touchcancel ".split(" ").join(".kb ");g.$allKeys=g.$keyboard.find("button."+b.keyButton).unbind(c).bind(f.keyBinding.split(" ").join(".keyboard ")+".keyboard "+a.keyboard.events.kbRepeater,function(c){if(c.preventDefault(),!g.$keyboard.is(":visible"))return!1;var d,e,h,i=this,j=a(i),k=g.getLayers(j),l=k.map(function(){return a(this).attr("data-curtxt")}).get(),m=(new Date).getTime();if(k.each(function(a,b){return b===i?(d=a,!1):void 0}),h=0>d?j:k.eq(d+j.data("curnum")),e=h.attr("data-action"),e=":"===e?":":(e||"").split(":")[0],!(m-(g.last.eventTime||0)<f.preventDoubleEventTime)){if(g.last.eventTime=m,g.$preview.focus(),g.$lastKey=h,g.last.key=h.attr("data-curtxt"),g.checkCaret&&g.$preview.caret(g.last),e.match("meta")&&(e="meta"),a.keyboard.keyaction.hasOwnProperty(e)&&a(this).hasClass(b.keyAction)){if(a.keyboard.keyaction[e](g,this,c)===!1)return!1}else"undefined"!=typeof e&&(l=g.last.key=g.wheel&&!a(this).hasClass(b.keyAction)?g.last.key:e,g.insertText(l),g.capsLock||f.stickyShift||c.shiftKey||(g.shiftActive=!1,g.showKeySet(this)));return g.$preview.focus().caret(g.last),g.checkCombos(),g.$el.trigger(a.keyboard.events.kbChange,[g,g.el]),g.last.val=g.$preview.val(),a.isFunction(f.change)?(f.change(a.Event(a.keyboard.events.inputChange),g,g.el),!1):void 0}}).bind("mouseenter.keyboard mouseleave.keyboard touchstart.keyboard",function(c){if(g.isCurrent()){var d=a(this),e=g.getLayers(d),h=(e.length?e.map(function(){return a(this).attr("data-curtxt")||""}).get():"")||[d.find("."+b.keyText).text()];"mouseenter"!==c.type&&"touchstart"!==c.type||"password"===g.el.type||d.hasClass(f.css.buttonDisabled)||d.addClass(f.css.buttonHover).attr("title",function(a,b){return g.wheel&&""===b&&g.sets&&h.length>1&&"touchstart"!==c.type?f.wheelMessage:b}),"mouseleave"===c.type&&(d.data({curtxt:d.data("original"),curnum:0}),d.removeClass("password"===g.el.type?"":f.css.buttonHover).attr("title",function(a,b){return b===f.wheelMessage?"":b}).find("."+b.keyText).html(d.data("original")))}}).bind("mouseup.keyboard mouseleave.kb touchend.kb touchmove.kb touchcancel.kb",function(b){return/(mouseleave|touchend|touchcancel)/i.test(b.type)?a(this).removeClass(f.css.buttonHover):(g.isVisible()&&g.isCurrent()&&g.$preview.focus(),g.checkCaret&&g.$preview.caret(g.last)),g.mouseRepeat=[!1,""],clearTimeout(g.repeater),!1}).bind("click.keyboard",function(){return!1}).not("."+b.keyAction).bind("mousewheel.keyboard",function(c,d){if(g.wheel){d=d||c.deltaY;var e,f=a(this),h=g.getLayers(f),i=h.length&&h.map(function(){return a(this).attr("data-curtxt")}).get()||[f.find("."+b.keyText).text()];return i.length>1?(e=f.data("curnum")+(d>0?-1:1),e>i.length-1&&(e=0),0>e&&(e=i.length-1)):e=0,f.data({curnum:e,layers:i,curtxt:i[e]}),f.find("."+b.keyText).html(i[e]),!1}}).add("."+b.keyPrefix+"tab bksp space enter".split(" ").join(",."+b.keyPrefix),g.$keyboard).bind("mousedown.kb touchstart.kb",function(){if(0!==f.repeatRate){var b=a(this);g.mouseRepeat=[!0,b],setTimeout(function(){g.mouseRepeat[0]&&g.mouseRepeat[1]===b&&g.repeatKey(b)},f.repeatDelay)}return!1})},g.insertText=function(a){var b,c,d,e=g.$preview.val(),f=g.$preview.caret(),h=g.$preview.scrollLeft(),i=g.$preview.scrollTop(),j=e.length;f.end<f.start&&(f.end=f.start),f.start>j&&(f.end=f.start=j),"TEXTAREA"===g.preview.tagName&&(g.msie&&"\n"===e.substr(f.start,1)&&(f.start+=1,f.end+=1),d=e.split("\n").length-1,g.preview.scrollTop=d>0?g.lineHeight*d:i),b="bksp"===a&&f.start===f.end?!0:!1,a="bksp"===a?"":a,c=f.start+(b?-1:a.length),h+=parseInt(g.$preview.css("fontSize"),10)*("bksp"===a?-1:1),g.$preview.val(g.$preview.val().substr(0,f.start-(b?1:0))+a+g.$preview.val().substr(f.end)).scrollLeft(h).caret(c,c),g.last.start=g.last.end=c},g.checkMaxLength=function(){var a,b,c=g.$preview.val();f.maxLength!==!1&&c.length>f.maxLength&&(a=g.$preview.caret().start,b=Math.min(a,f.maxLength),f.maxInsert||(c=g.last.val,b=a-1),g.$preview.val(c.substring(0,f.maxLength)),g.$preview.caret(b,b),g.last.start=g.last.end=b),g.$decBtn.length&&g.checkDecimal()},g.repeatKey=function(b){b.trigger(a.keyboard.events.kbRepeater),g.mouseRepeat[0]&&(g.repeater=setTimeout(function(){g.repeatKey(b)},g.repeatTime))},g.showKeySet=function(b){f=g.options;var c=a.keyboard.css,d="",e=(g.shiftActive?1:0)+(g.altActive?2:0);return g.shiftActive||(g.capsLock=!1),g.metaActive?(d=b&&b.name&&/meta/i.test(b.name)?b.name:"",""===d?d=g.metaActive===!0?"":g.metaActive:g.metaActive=d,(!f.stickyShift&&g.last.keyset[2]!==g.metaActive||(g.shiftActive||g.altActive)&&!g.$keyboard.find("."+c.keySet+"-"+d+g.rows[e]).length)&&(g.shiftActive=g.altActive=!1)):!f.stickyShift&&g.last.keyset[2]!==g.metaActive&&g.shiftActive&&(g.shiftActive=g.altActive=!1),e=(g.shiftActive?1:0)+(g.altActive?2:0),d=0!==e||g.metaActive?""===d?"":"-"+d:"-normal",g.$keyboard.find("."+c.keySet+d+g.rows[e]).length?(g.$keyboard.find("."+c.keyPrefix+"alt,."+c.keyPrefix+"shift,."+c.keyAction+"[class*=meta]").removeClass(f.css.buttonActive).end().find("."+c.keyPrefix+"alt").toggleClass(f.css.buttonActive,g.altActive).end().find("."+c.keyPrefix+"shift").toggleClass(f.css.buttonActive,g.shiftActive).end().find("."+c.keyPrefix+"lock").toggleClass(f.css.buttonActive,g.capsLock).end().find("."+c.keySet).hide().end().find("."+c.keySet+d+g.rows[e]).show().end().find("."+c.keyAction+"."+c.keyboard+d).addClass(f.css.buttonActive),g.last.keyset=[g.shiftActive,g.altActive,g.metaActive],void g.$el.trigger(a.keyboard.events.kbKeysetChange,[g,g.el])):(g.shiftActive=g.last.keyset[0],g.altActive=g.last.keyset[1],void(g.metaActive=g.last.keyset[2]))},g.checkCombos=function(){if(!g.isVisible())return g.$preview.val();var b,c,d,e,h=g.$preview.val(),i=g.$preview.caret(),j=a.keyboard.builtLayouts[g.layout],k=h.length;if(i.end<i.start&&(i.end=i.start),i.start>k&&(i.end=i.start=k),g.msie&&"\n"===h.substr(i.start,1)&&(i.start+=1,i.end+=1),f.useCombos&&(g.msie?h=h.replace(g.regex,function(a,b,c){return f.combos.hasOwnProperty(b)?f.combos[b][c]||a:a}):g.$preview.length&&(d=i.start-(i.start-2>=0?2:0),g.$preview.caret(d,i.end),e=(g.$preview.caret().text||"").replace(g.regex,function(a,b,c){return f.combos.hasOwnProperty(b)?f.combos[b][c]||a:a}),g.$preview.val(g.$preview.caret().replace(e)),h=g.$preview.val())),f.restrictInput&&""!==h){for(d=h,c=j.acceptedKeys.length,b=0;c>b;b++)""!==d&&(e=j.acceptedKeys[b],h.indexOf(e)>=0&&(/[\[|\]|\\|\^|\$|\.|\||\?|\*|\+|\(|\)|\{|\}]/g.test(e)&&(e="\\"+e),d=d.replace(new RegExp(e,"g"),"")));""!==d&&(h=h.replace(d,""))}return i.start+=h.length-k,i.end+=h.length-k,g.$preview.val(h),g.$preview.caret(i.start,i.end),g.preview.scrollTop=g.lineHeight*(h.substring(0,i.start).split("\n").length-1),g.last.start=i.start,g.last.end=i.end,g.checkMaxLength(),f.acceptValid&&g.checkValid(),h},g.checkValid=function(){var b=a.keyboard.css,c=!0;f.validate&&"function"==typeof f.validate&&(c=f.validate(g,g.$preview.val(),!1)),g.$keyboard.find("."+b.keyPrefix+"accept").toggleClass(b.inputInvalid,!c).toggleClass(b.inputValid,c)},g.checkDecimal=function(){g.decimal&&/\./g.test(g.preview.value)||!g.decimal&&/\,/g.test(g.preview.value)?g.$decBtn.attr({disabled:"disabled","aria-disabled":"true"}).removeClass(f.css.buttonDefault+" "+f.css.buttonHover).addClass(f.css.buttonDisabled):g.$decBtn.removeAttr("disabled").attr({"aria-disabled":"false"}).addClass(f.css.buttonDefault).removeClass(f.css.buttonDisabled)},g.getLayers=function(b){var c=a.keyboard.css,d=b.attr("data-pos"),e=b.closest("."+c.keyboard).find('button[data-pos="'+d+'"]');return e.filter(function(){return""!==a(this).find("."+c.keyText).text()})},g.switchInput=function(b,c){if("function"==typeof f.switchInput)f.switchInput(g,b,c);else{g.$keyboard.length&&g.$keyboard.hide();var d,e=!1,h=a("button, input, textarea, a").filter(":visible").not(":disabled"),i=h.index(g.$el)+(b?1:-1);if(g.$keyboard.length&&g.$keyboard.show(),i>h.length-1&&(e=f.stopAtEnd,i=0),0>i&&(e=f.stopAtEnd,i=h.length-1),!e){if(c=g.close(c),!c)return;d=h.eq(i).data("keyboard"),d&&d.options.openOn.length?d.focusOn():h.eq(i).focus()}}return!1},g.close=function(b){if(g.isOpen){clearTimeout(g.throttled);var c=a.keyboard.css,d=a.keyboard.events,e=b?g.checkCombos():g.originalContent;if(b&&f.validate&&"function"==typeof f.validate&&!f.validate(g,e,!0)&&(e=g.originalContent,b=!1,f.cancelClose))return;g.isCurrent(!1),g.isOpen=!1,g.$preview.val(e),g.$el.removeClass(c.isCurrent+" "+c.inputAutoAccepted).addClass(b?b===!0?"":c.inputAutoAccepted:"").trigger(f.alwaysOpen?"":d.kbBeforeClose,[g,g.el,b||!1]).val(e).scrollTop(g.el.scrollHeight).trigger(b?d.inputAccepted:d.inputCanceled,[g,g.el]).trigger(f.alwaysOpen?d.kbInactive:d.kbHidden,[g,g.el]).blur(),f.openOn&&(g.timer=setTimeout(function(){g.$el.bind(f.openOn+".keyboard",function(){g.focusOn()}),a(":focus")[0]===g.el&&g.$el.blur()},500)),!f.alwaysOpen&&g.$keyboard&&(g.$keyboard.remove(),g.$keyboard=[]),g.watermark||""!==g.el.value||""===g.inPlaceholder||g.$el.addClass(c.placeholder).val(g.inPlaceholder),g.$el.trigger(d.inputChange)}return!!b},g.accept=function(){return g.close(!0)},g.escClose=function(a){return a&&"keyup"===a.type?27===a.which?g.close():"":void(g.isOpen&&(!g.isCurrent()&&g.isOpen||g.isOpen&&a.target!==g.el&&!f.stayOpen)&&(g.allie&&a.preventDefault(),g.close(f.autoAccept?"true":!1)))},g.keyBtn=a("<button />").attr({role:"button",type:"button","aria-disabled":"false",tabindex:"-1"}).addClass(a.keyboard.css.keyButton),g.addKey=function(b,c,d){var e,h,i,j,k,l=a.keyboard.css,m=c.split(":"),n=m.length-1,o=d===!0?b:f.display[m[0]]||b,p=d===!0?b.charCodeAt(0):b;return/\(.+\)/.test(o)&&(j=o.replace(/\(([^()]+)\)/,""),i=o.match(/\(([^()]+)\)/)[1],o=j,k=j.split(":"),j=""!==k[0]&&k.length>1?k[0]:j,a.keyboard.builtLayouts[g.layout].mappedKeys[i]=j),k=o.split(":"),""===k[0]&&""===k[1]&&(o=":"),o=""!==k[0]&&k.length>1?k[0]:o,o=a.trim(d?o:m[1]||o),e=k.length>1?a.trim(k[1]).replace(/_/g," ")||"":n>0?m[n]||"":"",h=o.length>2?" "+l.keyWide:"",h+=d?"":" "+l.keyAction,g.keyBtn.clone().attr({"data-value":o,name:p,"data-pos":g.temp[1]+","+g.temp[2],title:e,"data-action":b,"data-original":o,"data-curtxt":o,"data-curnum":0}).addClass((""===p?"":l.keyPrefix+p+h+" ")+f.css.buttonDefault).html('<span class="'+l.keyText+'">'+o+"</span>").appendTo(g.temp[0])},g.customHash=function(){var a,b,c,d,e,g=f.customLayout,h=[],i=[];for(b in g)g.hasOwnProperty(b)&&h.push(g[b]);if(i=i.concat.apply(i,h).join(" "),c=0,e=i.length,0===e)return c;for(a=0;e>a;a++)d=i.charCodeAt(a),c=(c<<5)-c+d,c&=c;return c},g.buildKeyboard=function(){a.isEmptyObject(f.display)&&g.updateLanguage();var b,c,d,e,h,i,j,k,l,m=a.keyboard.css,n=0,o=a.keyboard.builtLayouts[g.layout]={mappedKeys:{},acceptedKeys:[]},p=o.acceptedKeys=[],q=a("<div />").addClass(m.keyboard+" "+f.css.container+(f.alwaysOpen?" "+m.alwaysOpen:"")).attr({role:"textbox"}).hide();return"custom"!==f.layout&&a.keyboard.layouts.hasOwnProperty(f.layout)||(f.layout="custom",a.keyboard.layouts.custom=f.customLayout||{normal:["{cancel}"]}),a.each(a.keyboard.layouts[f.layout],function(o,r){var s;if(""!==o&&!/^(name|lang|rtl)$/i.test(o))for("default"===o&&(o="normal"),n++,e=a("<div />").attr("name",o).addClass(m.keySet+" "+m.keySet+"-"+o).appendTo(q).toggle("normal"===o),d=0;d<r.length;d++){for(i=a.trim(r[d]).replace(/\{(\.?)[\s+]?:[\s+]?(\.?)\}/g,"{$1:$2}"),k=i.split(/\s+/),j=0;j<k.length;j++)if(g.temp=[e,d,j],h=!1,0!==k[j].length)if(/^\{\S+\}$/.test(k[j])){if(c=k[j].match(/^\{(\S+)\}$/)[1],/\!\!/.test(c)&&(c=c.replace("!!",""),h=!0),/^sp:((\d+)?([\.|,]\d+)?)(em|px)?$/i.test(c)&&(l=parseFloat(c.replace(/,/,".").match(/^sp:((\d+)?([\.|,]\d+)?)(em|px)?$/i)[1]||0),a('<span class="'+m.keyText+'">&nbsp;</span>').width(c.match(/px/i)?l+"px":2*l+"em").addClass(m.keyButton+" "+m.keySpacer).appendTo(e)),/^empty(:((\d+)?([\.|,]\d+)?)(em|px)?)?$/i.test(c)&&(l=/:/.test(c)?parseFloat(c.replace(/,/,".").match(/^empty:((\d+)?([\.|,]\d+)?)(em|px)?$/i)[1]||0):"",g.addKey(""," ").addClass(f.css.buttonDisabled+" "+f.css.buttonEmpty).attr("aria-disabled",!0).width(l?c.match("px")?l+"px":2*l+"em":"")),/^meta\d+\:?(\w+)?/i.test(c)){g.addKey(c.split(":")[0],c).addClass(m.keyHasActive);continue}switch(s=c.split(":"),s[0].toLowerCase()){case"a":case"accept":g.addKey("accept",c).addClass(f.css.buttonAction+" "+m.keyAction);break;case"alt":case"altgr":g.addKey("alt",c).addClass(m.keyHasActive);break;case"b":case"bksp":g.addKey("bksp",c);break;case"c":case"cancel":g.addKey("cancel",c).addClass(f.css.buttonAction+" "+m.keyAction);break;case"combo":g.addKey("combo",c).addClass(m.keyHasActive).toggleClass(f.css.buttonActive,f.useCombos);break;case"dec":p.push(g.decimal?".":","),g.addKey("dec",c);break;case"e":case"enter":g.addKey("enter",c).addClass(f.css.buttonAction+" "+m.keyAction);break;case"lock":g.addKey("lock",c).addClass(m.keyHasActive);break;case"s":case"shift":g.addKey("shift",c).addClass(m.keyHasActive);break;case"sign":p.push("-"),g.addKey("sign",c);break;case"space":p.push(" "),g.addKey("space",c);break;case"t":case"tab":g.addKey("tab",c);break;default:a.keyboard.keyaction.hasOwnProperty(s[0])&&g.addKey(s[0],c).toggleClass(f.css.buttonAction+" "+m.keyAction,h)}}else b=k[j],p.push(":"===b?b:b.split(":")[0]),g.addKey(b,b,!0);e.find("."+m.keyButton+":last").after('<br class="'+m.endRow+'">')}}),n>1&&(g.sets=!0),o.hasMappedKeys=!a.isEmptyObject(o.mappedKeys),o.$keyboard=q,q},g.destroy=function(){a(c).unbind("mousedown.keyboard keyup.keyboard touchstart.keyboard"),g.$keyboard.length&&g.$keyboard.remove();var b=a.keyboard.css,d=a.trim(f.openOn+" accepted beforeClose canceled change contextmenu hidden initialized keydown keypress keyup visible ").split(" ").join(".keyboard ");g.$el.removeClass([b.input,b.locked,b.placeholder,b.noKeyboard,b.alwaysOpen,f.css.input].join(" ")).removeAttr("aria-haspopup").removeAttr("role").unbind(d+".keyboard").removeData("keyboard")},g.init()},a.keyboard.css={input:"ui-keyboard-input",wrapper:"ui-keyboard-preview-wrapper",preview:"ui-keyboard-preview",keyboard:"ui-keyboard",keySet:"ui-keyboard-keyset",keyButton:"ui-keyboard-button",keyWide:"ui-keyboard-widekey",keyPrefix:"ui-keyboard-",keyText:"ui-keyboard-text",keyHasActive:"ui-keyboard-hasactivestate",keyAction:"ui-keyboard-actionkey",keySpacer:"ui-keyboard-spacer",locked:"ui-keyboard-lockedinput",alwaysOpen:"ui-keyboard-always-open",noKeyboard:"ui-keyboard-nokeyboard",placeholder:"ui-keyboard-placeholder",hasFocus:"ui-keyboard-has-focus",isCurrent:"ui-keyboard-input-current",inputValid:"ui-keyboard-valid-input",inputInvalid:"ui-keyboard-invalid-input",inputAutoAccepted:"ui-keyboard-autoaccepted",endRow:"ui-keyboard-button-endrow"},a.keyboard.events={kbChange:"change.keyboard",kbBeforeClose:"beforeClose",kbBeforeVisible:"beforeVisible",kbVisible:"visible",kbInit:"initialized.keyboard",kbInactive:"inactive.keyboard",kbHidden:"hidden.keyboard",kbRepeater:"repeater.keyboard",kbKeysetChange:"keysetChange",inputAccepted:"accepted.keyboard",inputCanceled:"canceled.keyboard",inputChange:"change"},a.keyboard.keyaction={accept:function(a){return a.close(!0),!1},alt:function(a,b){a.altActive=!a.altActive,a.showKeySet(b)},bksp:function(a){a.insertText("bksp")},cancel:function(a){return a.close(),!1},clear:function(a){a.$preview.val("")},combo:function(b){var c=!b.options.useCombos;return b.options.useCombos=c,b.$keyboard.find("."+a.keyboard.css.keyPrefix+"combo").toggleClass(b.options.css.buttonActive,c),c&&b.checkCombos(),!1},dec:function(a){a.insertText(a.decimal?".":",")},"default":function(a,b){a.shiftActive=a.altActive=a.metaActive=!1,a.showKeySet(b)},enter:function(b,c,d){var e=b.el.tagName,f=b.options;return d.shiftKey?f.enterNavigation?b.switchInput(!d[f.enterMod],!0):b.close(!0):f.enterNavigation&&("TEXTAREA"!==e||d[f.enterMod])?b.switchInput(!d[f.enterMod],f.autoAccept?"true":!1):void("TEXTAREA"===e&&a(d.target).closest("button").length&&b.insertText(" \n"))},lock:function(a,b){a.last.keyset[0]=a.shiftActive=a.capsLock=!a.capsLock,a.showKeySet(b)},left:function(a){var b=a.$preview.caret();b.start-1>=0&&(a.last.start=a.last.end=b.start-1)},meta:function(b,c){b.metaActive=!a(c).hasClass(a.keyboard.css.keyHasActive),b.showKeySet(c)},next:function(a){return a.switchInput(!0,a.options.autoAccept),!1},prev:function(a){return a.switchInput(!1,a.options.autoAccept),!1},right:function(a){var b=a.$preview.caret();b.start+1<=a.$preview.val().length&&(a.last.start=a.last.end=b.start+1)},shift:function(a,b){a.last.keyset[0]=a.shiftActive=!a.shiftActive,a.showKeySet(b)},sign:function(a){/^\-?\d*\.?\d*$/.test(a.$preview.val())&&a.$preview.val(-1*a.$preview.val())},space:function(a){a.insertText(" ")},tab:function(a){var b=a.el.tagName,c=a.options;return"INPUT"===b?c.tabNavigation?a.switchInput(!a.shiftActive,!0):!1:void a.insertText("	")}},a.keyboard.builtLayouts={},a.keyboard.layouts={alpha:{normal:["` 1 2 3 4 5 6 7 8 9 0 - = {bksp}","{tab} a b c d e f g h i j [ ] \\","k l m n o p q r s ; ' {enter}","{shift} t u v w x y z , . / {shift}","{accept} {space} {cancel}"],shift:["~ ! @ # $ % ^ & * ( ) _ + {bksp}","{tab} A B C D E F G H I J { } |",'K L M N O P Q R S : " {enter}',"{shift} T U V W X Y Z < > ? {shift}","{accept} {space} {cancel}"]},qwerty:{normal:["` 1 2 3 4 5 6 7 8 9 0 - = {bksp}","{tab} q w e r t y u i o p [ ] \\","a s d f g h j k l ; ' {enter}","{shift} z x c v b n m , . / {shift}","{accept} {space} {cancel}"],shift:["~ ! @ # $ % ^ & * ( ) _ + {bksp}","{tab} Q W E R T Y U I O P { } |",'A S D F G H J K L : " {enter}',"{shift} Z X C V B N M < > ? {shift}","{accept} {space} {cancel}"]},international:{normal:["` 1 2 3 4 5 6 7 8 9 0 - = {bksp}","{tab} q w e r t y u i o p [ ] \\","a s d f g h j k l ; ' {enter}","{shift} z x c v b n m , . / {shift}","{accept} {alt} {space} {alt} {cancel}"],shift:["~ ! @ # $ % ^ & * ( ) _ + {bksp}","{tab} Q W E R T Y U I O P { } |",'A S D F G H J K L : " {enter}',"{shift} Z X C V B N M < > ? {shift}","{accept} {alt} {space} {alt} {cancel}"],alt:["~ ¡ ² ³ ¤ € ¼ ½ ¾ ‘ ’ ¥ × {bksp}","{tab} ä å é ® þ ü ú í ó ö « » ¬","á ß ð f g h j k ø ¶ ´ {enter}","{shift} æ x © v b ñ µ ç > ¿ {shift}","{accept} {alt} {space} {alt} {cancel}"],"alt-shift":["~ ¹ ² ³ £ € ¼ ½ ¾ ‘ ’ ¥ ÷ {bksp}","{tab} Ä Å É ® Þ Ü Ú Í Ó Ö « » ¦","Ä § Ð F G H J K Ø ° ¨ {enter}","{shift} Æ X ¢ V B Ñ µ Ç . ¿ {shift}","{accept} {alt} {space} {alt} {cancel}"]},colemak:{normal:["` 1 2 3 4 5 6 7 8 9 0 - = {bksp}","{tab} q w f p g j l u y ; [ ] \\","{bksp} a r s t d h n e i o ' {enter}","{shift} z x c v b k m , . / {shift}","{accept} {space} {cancel}"],shift:["~ ! @ # $ % ^ & * ( ) _ + {bksp}","{tab} Q W F P G J L U Y : { } |",'{bksp} A R S T D H N E I O " {enter}',"{shift} Z X C V B K M < > ? {shift}","{accept} {space} {cancel}"]},dvorak:{normal:["` 1 2 3 4 5 6 7 8 9 0 [ ] {bksp}","{tab} ' , . p y f g c r l / = \\","a o e u i d h t n s - {enter}","{shift} ; q j k x b m w v z {shift}","{accept} {space} {cancel}"],shift:["~ ! @ # $ % ^ & * ( ) { } {bksp}",'{tab} " < > P Y F G C R L ? + |',"A O E U I D H T N S _ {enter}","{shift} : Q J K X B M W V Z {shift}","{accept} {space} {cancel}"]},num:{normal:["= ( ) {b}","{clear} / * -","7 8 9 +","4 5 6 {sign}","1 2 3 %","0 {dec} {a} {c}"]}},a.keyboard.language=a.extend({},a.keyboard.language,{en:{display:{a:"✔:Accept (Shift-Enter)",accept:"Accept:Accept (Shift-Enter)",alt:"Alt:⌥ AltGr",b:"⌫:Backspace",bksp:"Bksp:Backspace",c:"✖:Cancel (Esc)",cancel:"Cancel:Cancel (Esc)",clear:"C:Clear",combo:"ö:Toggle Combo Keys",dec:".:Decimal",e:"⏎:Enter",empty:" ",enter:"Enter:Enter ⏎",left:"←",lock:"Lock:⇪ Caps Lock",next:"Next ⇨",prev:"⇦ Prev",right:"→",s:"⇧:Shift",shift:"Shift:Shift",sign:"±:Change Sign",space:"&nbsp;:Space",t:"⇥:Tab",tab:"⇥ Tab:Tab"},wheelMessage:"Use mousewheel to see other keys",comboRegex:/([`\'~\^\"ao])([a-z])/gim,combos:{"`":{a:"à",A:"À",e:"è",E:"È",i:"ì",I:"Ì",o:"ò",O:"Ò",u:"ù",U:"Ù",y:"ỳ",Y:"Ỳ"},"'":{a:"á",A:"Á",e:"é",E:"É",i:"í",I:"Í",o:"ó",O:"Ó",u:"ú",U:"Ú",y:"ý",Y:"Ý"},'"':{a:"ä",A:"Ä",e:"ë",E:"Ë",i:"ï",I:"Ï",o:"ö",O:"Ö",u:"ü",U:"Ü",y:"ÿ",Y:"Ÿ"},"^":{a:"â",A:"Â",e:"ê",E:"Ê",i:"î",I:"Î",o:"ô",O:"Ô",u:"û",U:"Û",y:"ŷ",Y:"Ŷ"},"~":{a:"ã",A:"Ã",e:"ẽ",E:"Ẽ",i:"ĩ",I:"Ĩ",o:"õ",O:"Õ",u:"ũ",U:"Ũ",y:"ỹ",Y:"Ỹ",n:"ñ",N:"Ñ"}}}}),a.keyboard.defaultOptions={language:null,rtl:!1,layout:"qwerty",customLayout:null,position:{of:null,my:"center top",at:"center top",at2:"center bottom"},reposition:!0,usePreview:!0,alwaysOpen:!1,initialFocus:!0,stayOpen:!1,css:{input:"ui-widget-content ui-corner-all",container:"ui-widget-content ui-widget ui-corner-all ui-helper-clearfix",buttonDefault:"ui-state-default ui-corner-all",buttonHover:"ui-state-hover",buttonAction:"ui-state-active",buttonActive:"ui-state-active",buttonDisabled:"ui-state-disabled",buttonEmpty:"ui-keyboard-empty"},autoAccept:!1,lockInput:!1,restrictInput:!1,acceptValid:!1,cancelClose:!0,tabNavigation:!1,enterNavigation:!1,enterMod:"altKey",stopAtEnd:!0,appendLocally:!1,appendTo:"body",stickyShift:!0,preventPaste:!1,caretToEnd:!1,maxLength:!1,maxInsert:!0,repeatDelay:500,repeatRate:20,resetDefault:!1,openOn:"focus",keyBinding:"mousedown touchstart",useCombos:!0,validate:function(){return!0}},a.keyboard.comboRegex=/([`\'~\^\"ao])([a-z])/gim,a.keyboard.currentKeyboard="",a.fn.keyboard=function(b){return this.each(function(){a(this).data("keyboard")||new a.keyboard(this,b)})},a.fn.getkeyboard=function(){return this.data("keyboard")}}(jQuery,window,document),function(a,b,c,d){"use strict";a.fn.caret=function(a,e){if("undefined"==typeof this[0]||this.is(":hidden")||"hidden"===this.css("visibility"))return this;var f,g,h,i,j,k,l,m,n,o=document.selection,p=this[0],q=p.scrollTop,r=!1,s=!0;try{r="selectionStart"in p}catch(t){s=!1}return"object"==typeof a&&"start"in a&&"end"in a?(g=a.start,i=a.end):"number"==typeof a&&"number"==typeof e&&(g=a,i=e),s&&"undefined"!=typeof g?(/(email|number)/i.test(p.type)||(r?(p.selectionStart=g,p.selectionEnd=i):(j=p.createTextRange(),j.collapse(!0),j.moveStart("character",g),j.moveEnd("character",i-g),j.select())),(this.is(":visible")||"hidden"!==this.css("visibility"))&&this.focus(),p.scrollTop=q,this):(/(email|number)/i.test(p.type)?f=h=this.val().length:r?(f=p.selectionStart,h=p.selectionEnd):o?"TEXTAREA"===p.tagName?(n=this.val(),k=o[c](),l=k[d](),l.moveToElementText(p),l.setEndPoint("EndToEnd",k),f=l.text.replace(/\r/g,"\n")[b],h=f+k.text.replace(/\r/g,"\n")[b]):(n=this.val().replace(/\r/g,"\n"),k=o[c]()[d](),k.moveEnd("character",n[b]),f=""===k.text?n[b]:n.lastIndexOf(k.text),k=o[c]()[d](),k.moveStart("character",-n[b]),h=k.text[b]):(f=0,h=(p.value||"").length),m=(p.value||"").substring(f,h),{start:f,end:h,text:m,replace:function(a){return p.value.substring(0,f)+a+p.value.substring(h,p.value[b])}})}}(jQuery,"length","createRange","duplicate");