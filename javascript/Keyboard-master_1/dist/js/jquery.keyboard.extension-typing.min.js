/*! jQuery UI Virtual Keyboard Typing Simulator v1.7 */
!function(a){a.fn.addTyping=function(b){var c={showTyping:!0,lockTypeIn:!1,delay:250};return this.each(function(){var d,e=a(this).data("keyboard");e&&(d=e.typing_options=a.extend({},c,b),e.typing_keymap={" ":"space",'"':"34","'":"39","&nbsp;":"space","\b":"bksp","\n":"Enter","\r":"Enter","	":"tab"},e.typing_xref={8:"bksp",9:"tab",13:"enter",32:"space"},e.typing_event=!1,d.savedLockInput=e.options.lockInput,e.typing_setup=function(){var a=e.$preview?e.$preview:e.$el;a.unbind("keyup.keyboard-typing keydown.keyboard-typing keypress.keyboard-typing").bind("keyup.keyboard-typing",function(a){if(d.init&&d.lockTypeIn)return!1;if(!(a.which>=37&&a.which<=40))return 16===a.which&&(e.shiftActive=!1),18===a.which&&(e.altActive=!1),16===a.which||18===a.which?(e.showKeySet(),void setTimeout(function(){e.$preview.focus()},200)):void 0}).bind("keydown.keyboard-typing",function(a){return d.init&&d.lockTypeIn?!1:(a.temp=!1,16===a.which&&(a.temp=!e.shiftActive,e.shiftActive=!0),18===a.which&&(a.temp=!e.altActive,e.altActive=!0),a.temp&&(e.showKeySet(),e.$preview.focus()),e.typing_event=!0,void((8===a.which||9===a.which)&&e.typing_findKey("",a)))}).bind("keypress.keyboard-typing",function(a){return d.init&&d.lockTypeIn?!1:void(e.typing_event&&!e.options.lockInput&&e.typing_findKey("",a))})},e.typeIn=function(a,b,c,f){if(!e.isVisible())return e.typing_event=d.init=!1,e.options.lockInput=d.savedLockInput,void clearTimeout(e.typing_timer);if(e.typing_event){if("undefined"==typeof a)return e.typing_event=!1,void(e.options.lockInput=d.savedLockInput)}else d.init!==!0&&(d.init=!0,e.options.lockInput=d.lockTypeIn,a=d.text=a||"",d.len=a.length-1,d.delay=b||300,d.current=0,c&&(d.callback=c)),a=d.text.substring(d.current,++d.current),e.typing_findKey(a,f)},e.typing_findKey=function(b,c){var f,g,h,i,j,k,l,m,n=a.keyboard.css,o=a.keyboard.builtLayouts[e.layout].mappedKeys;if(k=e.$keyboard.find("."+n.keySet),i=e.typing_keymap.hasOwnProperty(b)?e.typing_keymap[b]:b,f="."+n.keyButton+'[data-value="'+i+'"]',e.typing_event&&c&&(e.typing_xref.hasOwnProperty(c.keyCode||c.which)?f="."+n.keyPrefix+e.typing_xref[c.keyCode||c.which]:(g=String.fromCharCode(c.charCode||c.which),f=o.hasOwnProperty(g)?"."+n.keyButton+'[data-value="'+o[g]+'"]':"."+n.keyPrefix+(c.charCode||c.which))),j=k.filter(":visible").find(f),j.length?e.typing_simulateKey(j,b):(e.typing_event?j=k.find(f):(h=e.typing_keymap.hasOwnProperty(b)?e.typing_keymap[b]:b.charCodeAt(0),"bksp"===h&&(b=h),j=k.find("."+n.keyPrefix+h)),m=j.closest("."+n.keySet),m.attr("name")?(l=m.attr("name"),e.shiftActive=/shift/.test(l),e.altActive=/alt/.test(l),e.metaActive=e.last.keyset[2]=l.match(/meta\d+/)||!1,e.showKeySet({name:e.metaActive}),e.typing_simulateKey(j,b)):e.typing_event||(e.insertText(b),e.checkCombos())),d.current<=d.len&&0!==d.len){if(!e.isVisible())return;setTimeout(function(){e.typeIn()},d.delay)}else{if(0!==d.len)return e.typing_event=d.init=!1,e.options.lockInput=d.savedLockInput,d.len=d.current=0,void(a.isFunction(d.callback)&&setTimeout(function(){a.isFunction(d.callback)&&d.callback(e)},d.delay));d.len=d.current=0,d.text="",e.typing_event=d.init=!1,e.options.lockInput=d.savedLockInput}},e.typing_simulateKey=function(a,b){var c=a.length;c&&a.filter(":visible").trigger("mouseenter.keyboard"),e.typing_timer=setTimeout(function(){var c=a.length;c&&setTimeout(function(){a.trigger("mouseleave.keyboard")},d.delay/3),e.isVisible()&&(e.typing_event||(e.insertText(b),e.checkCombos()))},d.delay/3)},d.showTyping&&(e.options.alwaysOpen&&e.isVisible()&&e.typing_setup(),e.$el.bind("visible.keyboard",function(){e.typing_setup()})))})}}(jQuery);